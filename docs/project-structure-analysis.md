# AI Novel Cursor - プロジェクト構造分析と構築プラン

## 📋 プロジェクト概要分析

### 🎯 プロジェクト背景
**目的**: AI展示会での技術デモンストレーション  
**アピールポイント**: AIによる整合性のとれた長文生成  
**重要要素**: ビジュアライズ・可視化  
**将来展望**: 調達仕様書、契約書、提案書等の自動生成システムへ発展  

### 🏗️ 技術スタック要件
- **UI Framework**: CopilotKit
- **Agent Framework**: AG2 (AgentOS)
- **Interaction Protocol**: AG-UI Protocol
- **LLM**: Celebras Llama-3.3-70B
- **Deploy Platform**: Koyoeb (GitHub自動連携)

### 📝 プロンプトファイル分析

#### 1. プロット検討プロンプト（generate_doc/プロット検討プロンプト.md）
**機能**: ユーザー入力から物語コンセプトを生成
**特徴**:
- 3段階プロセス（分析 → コンセプト出力 → Mermaid図）
- _scratchpad_, _answer_, _mermaid_ セクション
- キャラクター、設定、テーマ等の構造化分析
- 感情的・知的魅力の重視

**技術的考慮点**:
- プロンプトが長文（56行）
- 構造化された出力形式
- Mermaid図生成機能が必要

#### 2. 目次検討プロンプト（generate_doc/目次検討.md）
**機能**: 12章60節構成の詳細アウトライン生成
**特徴**:
- 入力変数: $PLOT_OVERVIEW, $TITLE_STYLE, $STRUCTURE_GUIDE, $THEME
- 厳密な構造（12章 × 5節 = 60節）
- 各節400-500語、章要約500語
- 一人称視点の統一
- メタファー・抽象・逆説的タイトル

**技術的考慮点**:
- 複数変数の動的置換が必要
- 大量のテキスト生成（約30,000-42,000語）
- 構造化された出力フォーマット

#### 3. 小説執筆プロンプト（generate_doc/小説執筆.md）
**機能**: 本格的な小説執筆の実行
**特徴**:
- 超詳細な執筆ガイドライン（198行）
- 各節5,000-7,000語の本格執筆
- 9つの主要カテゴリー（構成、ストーリー、キャラクター等）
- 文学的品質の重視

**技術的考慮点**:
- 最も長文のプロンプト
- 高度な文章生成能力が必要
- 一貫性とクオリティの担保

## 🏛️ システム設計方針

### 1. プロンプト管理システム
```
📁 prompts/
├── 📄 plot-analysis.md (プロット検討)
├── 📄 outline-generation.md (目次検討) 
├── 📄 novel-writing.md (小説執筆)
└── 📄 prompt-templates/ (変数テンプレート)
```

**設計ポイント**:
- 長文プロンプトの外部ファイル化
- 変数置換機能（$VARIABLE → 実際の値）
- バージョン管理とテスト機能
- プロンプト品質の検証機能

### 2. エージェント構成設計
```
🤖 Multi-Agent System (AG2)
├── 📊 PlotAnalyzer (プロット分析)
├── 📋 OutlineGenerator (目次生成)
├── ✍️ NovelWriter (小説執筆)
├── 🎨 MermaidGenerator (図表生成)
└── 📝 QualityValidator (品質検証)
```

**エージェント間通信**:
- AG-UI Protocol準拠
- 段階的なデータ受け渡し
- 並列処理とシーケンシャル処理の最適化

### 3. UI設計（CopilotKit活用）
```
🖥️ Main Interface
├── 📝 Input Panel (タイトル・補足説明)
├── 🔄 Process Visualization (エージェント連携可視化)
├── 📊 Progress Dashboard (進行状況)
├── 📖 Output Display (生成結果)
└── 🐛 Debug Console (詳細ログ)
```

**CopilotKit特性活用**:
- Conversational UI
- Real-time collaboration
- Contextual assistance
- Interactive components

## 🚀 構築プラン詳細

### Phase 1: 基盤構築
**期間**: 2週間  
**内容**:
- プロジェクト初期化
- 技術スタック統合
- 基本的なUI構築
- プロンプト管理システム

**成果物**:
- Next.js + CopilotKit基盤
- AG2エージェント基本構成
- プロンプトファイルの外部化
- 基本ログシステム

### Phase 2: エージェント実装
**期間**: 3週間  
**内容**:
- 各種エージェントの実装
- AG-UI Protocol統合
- エージェント間通信の実装
- プロンプト処理エンジン

**成果物**:
- 5つの専門エージェント
- エージェント通信プロトコル
- 変数置換システム
- エラーハンドリング機能

### Phase 3: UI統合・可視化
**期間**: 2週間  
**内容**:
- CopilotKitコンポーネント統合
- エージェント連携の可視化
- リアルタイム進行状況表示
- ユーザーインタラクション

**成果物**:
- インタラクティブUI
- エージェント状態の可視化
- プログレスバーとステータス表示
- ユーザーフレンドリーなインターフェース

### Phase 4: 品質向上・最適化
**期間**: 1週間  
**内容**:
- パフォーマンス最適化
- エラーハンドリング強化
- ログシステム詳細化
- テスト機能追加

**成果物**:
- 本番レベルの品質
- 包括的なログシステム
- 自動テスト機能
- パフォーマンス監視

## 🎯 成功指標

### 技術デモ要件
✅ **CopilotKit**: 直感的なUI操作  
✅ **AG2**: 複数エージェントの協調動作  
✅ **AG-UI**: スムーズなエージェント-ユーザー間通信  
✅ **可視化**: エージェント連携プロセスの明確な表示  

### 出力品質要件
✅ **整合性**: 長文での論理的一貫性  
✅ **構造化**: 12章60節の適切な構成  
✅ **文学性**: 読み応えのある文章品質  
✅ **カスタマイズ**: ユーザー入力の適切な反映  

### システム要件
✅ **安定性**: エラー耐性と回復機能  
✅ **パフォーマンス**: 合理的な処理時間  
✅ **ログ**: 詳細なデバッグ情報  
✅ **スケーラビリティ**: 将来の機能拡張への対応  

---

**作成日**: 2024-12-19  
**バージョン**: 1.0  
**次回レビュー**: MVP実装完了後 